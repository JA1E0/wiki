
<!doctype html>
<html lang="zh" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <meta name="author" content="aWei">
      
      
        <link rel="canonical" href="https://wiki.noobwei.top/computer/security/threat_intelligence/APT/APT%26TTPs/">
      
      <link rel="icon" href="../../../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.2.2, mkdocs-material-7.2.5">
    
    
      
        <title>APT 分析及 TTPs 提取 - aWei's Wiki</title>
      
    
    
      <link rel="stylesheet" href="../../../../../assets/stylesheets/main.be71726b.min.css">
      
        
        <link rel="stylesheet" href="../../../../../assets/stylesheets/palette.3f5d1f46.min.css">
        
          
          
          <meta name="theme-color" content="#7e56c2">
        
      
    
    
    
      
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>:root{--md-text-font-family:"Roboto";--md-code-font-family:"Roboto Mono"}</style>
      
    
    
    
    
      


    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="" data-md-color-primary="deep-purple" data-md-color-accent="deep-purple">
  
    
    <script>function __prefix(e){return new URL("../../../../..",location).pathname+"."+e}function __get(e,t=localStorage){return JSON.parse(t.getItem(__prefix(e)))}</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#apt-ttps" class="md-skip">
          跳转至
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../../../.." title="aWei&#39;s Wiki" class="md-header__button md-logo" aria-label="aWei's Wiki" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            aWei's Wiki
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              APT 分析及 TTPs 提取
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="搜索" placeholder="搜索" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            正在初始化搜索引擎
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../../../.." title="aWei&#39;s Wiki" class="md-nav__button md-logo" aria-label="aWei's Wiki" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    aWei's Wiki
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_1" type="checkbox" id="__nav_1" >
      
      <label class="md-nav__link" for="__nav_1">
        选购商品
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="选购商品" data-md-level="1">
        <label class="md-nav__title" for="__nav_1">
          <span class="md-nav__icon md-icon"></span>
          选购商品
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_1_1" type="checkbox" id="__nav_1_1" >
      
      <label class="md-nav__link" for="__nav_1_1">
        GH60 客制化键盘
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="GH60 客制化键盘" data-md-level="2">
        <label class="md-nav__title" for="__nav_1_1">
          <span class="md-nav__icon md-icon"></span>
          GH60 客制化键盘
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../buy_someting/gh60/1_gh60_edition/" class="md-nav__link">
        0x01 GH60的各种版本
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../buy_someting/gh60/2_gh60_Materials/" class="md-nav__link">
        0x02 GH60的零件清单
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../buy_someting/gh60/3_gh60_install/" class="md-nav__link">
        0x03 GH60的拼装
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_1_2" type="checkbox" id="__nav_1_2" >
      
      <label class="md-nav__link" for="__nav_1_2">
        烤箱
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="烤箱" data-md-level="2">
        <label class="md-nav__title" for="__nav_1_2">
          <span class="md-nav__icon md-icon"></span>
          烤箱
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../buy_someting/oven_%E5%BE%AE%E6%B3%A2%E7%82%89/1_oven_knowledge/" class="md-nav__link">
        烤箱选购
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../buy_someting/oven_%E5%BE%AE%E6%B3%A2%E7%82%89/2_oven_experience/" class="md-nav__link">
        使用心得
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_1_3" type="checkbox" id="__nav_1_3" >
      
      <label class="md-nav__link" for="__nav_1_3">
        厨刀
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="厨刀" data-md-level="2">
        <label class="md-nav__title" for="__nav_1_3">
          <span class="md-nav__icon md-icon"></span>
          厨刀
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../buy_someting/knife/knife/" class="md-nav__link">
        厨刀推荐
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_1_4" type="checkbox" id="__nav_1_4" >
      
      <label class="md-nav__link" for="__nav_1_4">
        跑步
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="跑步" data-md-level="2">
        <label class="md-nav__title" for="__nav_1_4">
          <span class="md-nav__icon md-icon"></span>
          跑步
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../buy_someting/running/jogging_winter/" class="md-nav__link">
        秋冬夜跑
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2" type="checkbox" id="__nav_2" checked>
      
      <label class="md-nav__link" for="__nav_2">
        计算机
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="计算机" data-md-level="1">
        <label class="md-nav__title" for="__nav_2">
          <span class="md-nav__icon md-icon"></span>
          计算机
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2_1" type="checkbox" id="__nav_2_1" >
      
      <label class="md-nav__link" for="__nav_2_1">
        windows编程
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="windows编程" data-md-level="2">
        <label class="md-nav__title" for="__nav_2_1">
          <span class="md-nav__icon md-icon"></span>
          windows编程
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../../windows_core_programming/Calling_convention/" class="md-nav__link">
        调用约定
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../../windows_core_programming/Inject/" class="md-nav__link">
        各种注入提示
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../../windows_core_programming/multi_thread/" class="md-nav__link">
        多线程有关
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
            
  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2_2" type="checkbox" id="__nav_2_2" checked>
      
      <label class="md-nav__link" for="__nav_2_2">
        信息安全
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="信息安全" data-md-level="2">
        <label class="md-nav__title" for="__nav_2_2">
          <span class="md-nav__icon md-icon"></span>
          信息安全
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2_2_1" type="checkbox" id="__nav_2_2_1" >
      
      <label class="md-nav__link" for="__nav_2_2_1">
        病毒分析
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="病毒分析" data-md-level="3">
        <label class="md-nav__title" for="__nav_2_2_1">
          <span class="md-nav__icon md-icon"></span>
          病毒分析
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2_2_1_1" type="checkbox" id="__nav_2_2_1_1" >
      
      <label class="md-nav__link" for="__nav_2_2_1_1">
        YARA
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="YARA" data-md-level="4">
        <label class="md-nav__title" for="__nav_2_2_1_1">
          <span class="md-nav__icon md-icon"></span>
          YARA
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../malware/YARA/creating_yara/" class="md-nav__link">
        编写Yara规则检测恶意软件
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../malware/YARA/yara_docs/" class="md-nav__link">
        官方文档与signature
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../malware/YARA/Kaspersky_yara_note/" class="md-nav__link">
        卡巴斯基yara笔记
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../office_cve/" class="md-nav__link">
        Office常见CVE
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
            
  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2_2_2" type="checkbox" id="__nav_2_2_2" checked>
      
      <label class="md-nav__link" for="__nav_2_2_2">
        威胁情报
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="威胁情报" data-md-level="3">
        <label class="md-nav__title" for="__nav_2_2_2">
          <span class="md-nav__icon md-icon"></span>
          威胁情报
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../awesome-threat-intelligence/" class="md-nav__link">
        威胁情报大合集
      </a>
    </li>
  

          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2_2_2_2" type="checkbox" id="__nav_2_2_2_2" >
      
      <label class="md-nav__link" for="__nav_2_2_2_2">
        OSINT
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="OSINT" data-md-level="4">
        <label class="md-nav__title" for="__nav_2_2_2_2">
          <span class="md-nav__icon md-icon"></span>
          OSINT
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../OSINT/bookmarks_menu/" class="md-nav__link">
        OSINT 书签
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../OSINT/OSINT_framework/" class="md-nav__link">
        OSINT 框架
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
            
  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2_2_2_3" type="checkbox" id="__nav_2_2_2_3" checked>
      
      <label class="md-nav__link" for="__nav_2_2_2_3">
        APT
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="APT" data-md-level="4">
        <label class="md-nav__title" for="__nav_2_2_2_3">
          <span class="md-nav__icon md-icon"></span>
          APT
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          APT 分析及 TTPs 提取
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        APT 分析及 TTPs 提取
      </a>
      
        
<nav class="md-nav md-nav--secondary" aria-label="目录">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      目录
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#abstract" class="md-nav__link">
    Abstract
  </a>
  
    <nav class="md-nav" aria-label="Abstract">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#0x00" class="md-nav__link">
    0x00 攻击事件
  </a>
  
    <nav class="md-nav" aria-label="0x00 攻击事件">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#0x00-01" class="md-nav__link">
    0x00-01 攻击事件甄别
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#0x00-02" class="md-nav__link">
    0x00-02 攻击事件的核心元素
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#0x01-apt" class="md-nav__link">
    0x01 APT
  </a>
  
    <nav class="md-nav" aria-label="0x01 APT">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#0x01-00-apt" class="md-nav__link">
    0x01-00 APT 攻击的特点
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#0x01-01-apt" class="md-nav__link">
    0x01-01 APT 入侵的方式
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#0x02-apt" class="md-nav__link">
    0x02 APT 事件分析
  </a>
  
    <nav class="md-nav" aria-label="0x02 APT 事件分析">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#0x02-00-apt" class="md-nav__link">
    0x02-00 APT 两种分析方法
  </a>
  
    <nav class="md-nav" aria-label="0x02-00 APT 两种分析方法">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_1" class="md-nav__link">
    通过攻击者“能力”切入分析：
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_2" class="md-nav__link">
    通过攻击者“基础设施”切入分析
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#0x02-01-ioc" class="md-nav__link">
    0x02-01 IoC 层级
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#0x03-ttps" class="md-nav__link">
    0x03 TTPs 提取
  </a>
  
    <nav class="md-nav" aria-label="0x03 TTPs 提取">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#0x03-00-ttp" class="md-nav__link">
    0x03-00 TTP 提取的难点
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#0x03-01" class="md-nav__link">
    0x03-01 特征矩阵
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#0x03-02" class="md-nav__link">
    0x03-02 事件链图
  </a>
  
    <nav class="md-nav" aria-label="0x03-02 事件链图">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#kill-chain" class="md-nav__link">
    KILL CHAIN
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_3" class="md-nav__link">
    攻击总是线性的
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#apt" class="md-nav__link">
    APT 分析单位
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#0x04-ttps" class="md-nav__link">
    0x04 TTPs 的使用及归因判断
  </a>
  
    <nav class="md-nav" aria-label="0x04 TTPs 的使用及归因判断">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#0x05-ttps" class="md-nav__link">
    0x05 TTPs 落地的思考
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#0x05-01" class="md-nav__link">
    0x05-01 实体抽取
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#0x05-02" class="md-nav__link">
    0x05-02 关系描述
  </a>
  
    <nav class="md-nav" aria-label="0x05-02 关系描述">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#attck-ttp" class="md-nav__link">
    ATT&amp;CK 对 TTP 提取的帮助
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#attck" class="md-nav__link">
    使用 ATT&amp;CK 进行关系映射
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#0x05-03" class="md-nav__link">
    0x05-03 完整的描述模型
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#0x06" class="md-nav__link">
    0x06 参考链接
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_4" class="md-nav__link">
    鸣谢
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2_2_3" type="checkbox" id="__nav_2_2_3" >
      
      <label class="md-nav__link" for="__nav_2_2_3">
        Web
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Web" data-md-level="3">
        <label class="md-nav__title" for="__nav_2_2_3">
          <span class="md-nav__icon md-icon"></span>
          Web
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../WEB/Practice_platform/" class="md-nav__link">
        Web练习平台
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../WEB/Linux_Privilege_Escalation/" class="md-nav__link">
        linux特权提升
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../hw_redteam/" class="md-nav__link">
        分析tips-redteam使用工具
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3" type="checkbox" id="__nav_3" >
      
      <label class="md-nav__link" for="__nav_3">
        工具
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="工具" data-md-level="1">
        <label class="md-nav__title" for="__nav_3">
          <span class="md-nav__icon md-icon"></span>
          工具
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../Tool/keyboard_shortcuts/" class="md-nav__link">
        工具设置
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../Tool/Tools/" class="md-nav__link">
        工具整理
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../Tool/common_code/" class="md-nav__link">
        常用调试代码
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../Tool/vscode_shortcuts/" class="md-nav__link">
        VsCode快捷键
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary" aria-label="目录">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      目录
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#abstract" class="md-nav__link">
    Abstract
  </a>
  
    <nav class="md-nav" aria-label="Abstract">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#0x00" class="md-nav__link">
    0x00 攻击事件
  </a>
  
    <nav class="md-nav" aria-label="0x00 攻击事件">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#0x00-01" class="md-nav__link">
    0x00-01 攻击事件甄别
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#0x00-02" class="md-nav__link">
    0x00-02 攻击事件的核心元素
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#0x01-apt" class="md-nav__link">
    0x01 APT
  </a>
  
    <nav class="md-nav" aria-label="0x01 APT">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#0x01-00-apt" class="md-nav__link">
    0x01-00 APT 攻击的特点
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#0x01-01-apt" class="md-nav__link">
    0x01-01 APT 入侵的方式
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#0x02-apt" class="md-nav__link">
    0x02 APT 事件分析
  </a>
  
    <nav class="md-nav" aria-label="0x02 APT 事件分析">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#0x02-00-apt" class="md-nav__link">
    0x02-00 APT 两种分析方法
  </a>
  
    <nav class="md-nav" aria-label="0x02-00 APT 两种分析方法">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_1" class="md-nav__link">
    通过攻击者“能力”切入分析：
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_2" class="md-nav__link">
    通过攻击者“基础设施”切入分析
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#0x02-01-ioc" class="md-nav__link">
    0x02-01 IoC 层级
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#0x03-ttps" class="md-nav__link">
    0x03 TTPs 提取
  </a>
  
    <nav class="md-nav" aria-label="0x03 TTPs 提取">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#0x03-00-ttp" class="md-nav__link">
    0x03-00 TTP 提取的难点
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#0x03-01" class="md-nav__link">
    0x03-01 特征矩阵
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#0x03-02" class="md-nav__link">
    0x03-02 事件链图
  </a>
  
    <nav class="md-nav" aria-label="0x03-02 事件链图">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#kill-chain" class="md-nav__link">
    KILL CHAIN
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_3" class="md-nav__link">
    攻击总是线性的
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#apt" class="md-nav__link">
    APT 分析单位
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#0x04-ttps" class="md-nav__link">
    0x04 TTPs 的使用及归因判断
  </a>
  
    <nav class="md-nav" aria-label="0x04 TTPs 的使用及归因判断">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#0x05-ttps" class="md-nav__link">
    0x05 TTPs 落地的思考
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#0x05-01" class="md-nav__link">
    0x05-01 实体抽取
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#0x05-02" class="md-nav__link">
    0x05-02 关系描述
  </a>
  
    <nav class="md-nav" aria-label="0x05-02 关系描述">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#attck-ttp" class="md-nav__link">
    ATT&amp;CK 对 TTP 提取的帮助
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#attck" class="md-nav__link">
    使用 ATT&amp;CK 进行关系映射
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#0x05-03" class="md-nav__link">
    0x05-03 完整的描述模型
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#0x06" class="md-nav__link">
    0x06 参考链接
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_4" class="md-nav__link">
    鸣谢
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                
                
                <blockquote>
<p><a href="https://projectsharp.org/2020/02/23/APT 分析及 TTPs 提取/?from=groupmessage&amp;isappinstalled=0">https://projectsharp.org/2020/02/23/APT%20%E5%88%86%E6%9E%90%E5%8F%8A%20TTPs%20%E6%8F%90%E5%8F%96/?from=groupmessage&amp;isappinstalled=0</a></p>
</blockquote>
<h1 id="apt-ttps">APT 分析及 TTPs 提取<a class="headerlink" href="#apt-ttps" title="Permanent link">&para;</a></h1>
<p>2020-02-23</p>
<p>by PIanet</p>
<h2 id="abstract">Abstract<a class="headerlink" href="#abstract" title="Permanent link">&para;</a></h2>
<p>本文对 APT 分析及 TTPs 提取进行讨论，总结出一套适用于安全分析、安全研究及企业应急响应人员的分析方法。</p>
<p>文章由六部分组成，引用了杀伤链模型，钻石分析模型，ATT&amp;CK 等内容，介绍了攻击事件、APT 攻击的一些概念，简单概括了 “通过攻击者能力切入” 和 “通过基础设施切入” 的两种 APT 事件分析的方法。着重探讨了 TTP 的提取、使用、应用、落地及归因判断。提出了 “特征矩阵” 和 “事件链图”，设计了描述模型，同时进行了简单的可行性论证。</p>
<p>内容适用于具有一定经验的安全分析师，病毒分析师，威胁情报分析师等安全人员。</p>
<h3 id="0x00">0x00 攻击事件<a class="headerlink" href="#0x00" title="Permanent link">&para;</a></h3>
<p>什么是攻击事件？</p>
<p>个人理解，攻击事件是在未授权情况下，对计算机系统或计算机资源进行访问、使用、更改、破坏的活动。根据事件烈度和影响范围，可以分为以下几类：</p>
<ul>
<li>常规攻击</li>
<li>Botnet</li>
<li>恶意软件</li>
<li>APT</li>
</ul>
<h4 id="0x00-01">0x00-01 攻击事件甄别<a class="headerlink" href="#0x00-01" title="Permanent link">&para;</a></h4>
<p>对攻击事件，可以从烈度、影响、指向以及特点等维度进行甄别。</p>
<ul>
<li>常规攻击</li>
</ul>
<p>常规攻击一般事件复杂度低，杂音少，线性且可直接推测出攻击目的。其中包括非定向钓鱼，端口，服务扫描，SQL 注入，拒绝服务攻击，会话劫持和中间人攻击，凭证重放等。此类型事件，影响少，危害可控且可在短时间内进行排查修复。</p>
<ul>
<li>Botnet</li>
</ul>
<p>僵尸网络的特点就是大规模攻击，数据说话，涉及到RAT。比如 Necurs、Gafgyt、Mirai 僵尸网络上的垃圾邮件、DDoS 等。</p>
<ul>
<li>恶意软件</li>
</ul>
<p>恶意软件指一些勒索、挖矿以及病毒木马。涉及钱包、矿池；目的不同，会包含 RAT；不同的入口，也会出现标志性的工具和利用。比如 WannaCry、Bad Rabbit、大量 MikroTik 路由器被感染进行恶意挖矿等。</p>
<ul>
<li>APT</li>
</ul>
<p>APT 攻击时间复杂度高，多个行为，多个指纹身份；有 loader、有Downloader、有 RAT、有 Malware。在所有攻击事件中是最难分析的一类。知名的 APT 组织：海莲花、摩诃草、APT28、Lazarus Group 等。APT 的目标通常是监视网络活动并窃取数据，而不是破坏网络或系统。</p>
<h4 id="0x00-02">0x00-02 攻击事件的核心元素<a class="headerlink" href="#0x00-02" title="Permanent link">&para;</a></h4>
<p><img alt="img" src="https://projectsharp.org/images/2020/02/23/apt-ttps/0.png" /></p>
<p>借用钻石模型中的概念，每一起攻击事件（Event）都包含四个核心元素：攻击者（Adversary）、受害者（Victim）、能力（Capability）和基础设施（Infrastructure）。</p>
<ul>
<li>攻击者：攻击事件的直接执行者 在一些大型的攻击事件中，攻击组织有完善的人员体系结构，这里所说的攻击者，是事件的直接操作者。</li>
<li>受害者：攻击者的目标 不同类型的的攻击事件中受害者表现也不同，可能是一台主机、一个企业或者一个机构。</li>
<li>能力：使用的工具或者技术</li>
</ul>
<p>能力是事件中攻击者所使用技术或者工具。从探查到最终目的达到，“技术”存在攻击过程的每一个阶段。</p>
<ul>
<li>基础设施：攻击者维持权限控制的通道或者载体。 基础设施可以理解为攻击的 C2 通道，可以分为三类：① 攻击者购买拥有 ② 攻击者攻陷的 ③ 使用的第三方平台或者服务。</li>
</ul>
<p>每一起攻击事件，都有一个攻击者通过基础设施上的能力对受害者产生影响，进而达成某种目的。所有攻击事件都是围绕这四者进行展开的。</p>
<p>在这四核心元素之上，又可以衍生出 “技术”，“社会” 维度，指导安全分析。在此不再展开，之后会单独做一个专题，使用钻石模型进行事件分析。</p>
<h2 id="0x01-apt">0x01 APT<a class="headerlink" href="#0x01-apt" title="Permanent link">&para;</a></h2>
<p>APT (Advanced Persistent Threat)，翻译为高级持续威胁。这类攻击报告，最早可以追溯到 2005 年 6 月，英国国家基础设施安全协调中心 (UK-NISCC) 和美国计算机应急响应小组 (US-CERT) 发布了技术警报公告，其中描述了有针对性的社交工程电子邮件，这些电子邮件包含特洛伊木马进行窃密。(LM White Paper Intel DrivenDefense）</p>
<p>这个概念炒了好几年，不同身份角色，站在不同角度都有自己的理解，就不过多解读。文章以下内容，限定在国家及组织对抗的 APT 攻击场景。</p>
<h3 id="0x01-00-apt">0x01-00 APT 攻击的特点<a class="headerlink" href="#0x01-00-apt" title="Permanent link">&para;</a></h3>
<p>国家及组织对抗的 APT 有以下几个特点：</p>
<ul>
<li>攻击目的性强，为了达到目的不择手段。</li>
<li>雄厚的支持</li>
</ul>
<p>分析中发现有大量漏洞利用和定制化工具使用，这反应出 APT 攻击需要耗费巨大的人力、物力。攻击者往往有政府或财团支持。</p>
<ul>
<li>目标价值高</li>
</ul>
<p>与投入相匹配，APT 攻击的目标价值往往也十分高，其攻击领域有：政府部门、军事部门、基础设施、金融机构、教育科研机构和大型企业等。</p>
<ul>
<li>时间复杂度高</li>
</ul>
<p>APT 攻击的另一个特点就是，时间复杂度高，持续时间长。即使有报告对 APT 组织进行披露，导致之前的攻击手段失效，但只要目标的价值还在，那么攻击还会发生。</p>
<h3 id="0x01-01-apt">0x01-01 APT 入侵的方式<a class="headerlink" href="#0x01-01-apt" title="Permanent link">&para;</a></h3>
<p>APT 攻击入侵的方式主要有：鱼叉式钓鱼、IM、水坑攻击、钓鱼网站、1/N day 漏洞、0 day 漏洞和物理接触。入侵包括载荷投递和突破防御两个阶段，各种入侵方式的成本如下图：</p>
<p><img alt="img" src="https://projectsharp.org/images/2020/02/23/apt-ttps/1.png" /></p>
<p>入侵方式金字塔，从下到上，入侵成本和危害程度逐层递增。</p>
<p>处于金字塔最底层的是鱼叉式钓鱼邮件和即时通讯软件，它是最常见、入侵成本最低的攻击方式。攻击者常常以鱼叉邮件做为攻击入口，精心构造邮件标题、正文和附件。用来投递恶意网址、伪装文件或者含有漏洞利用的文档。IM 与鱼叉邮件钓鱼类似。水坑攻击和钓鱼网站也是常见 APT 攻击入侵方法。侵入网站，加入恶意 JS 伪装更新；或者通过推特、fb、论坛上面通过发布、评论、转发等方式进行社交平台的水坑攻击。还可以制作钓鱼网站，通过邮件、IM、水坑等方式投递给受害者，窃取账号密码、收集主机信息或者诱惑下载恶意软件。这两种入侵方式的成本也不高。</p>
<p>防御边界的渗透攻击，针对的是受害系统、业务的防御边界，进行常规的渗透攻击，例如常见的 SQL 注入，文件上传，跨站脚本攻击、跨站请求伪造等。此类入侵方式较常规网络攻击并无不同，入侵的目的是突破防御边界，找到稳定且隐蔽的入口，渗透攻击在 APT 攻击中也是比较常见的。</p>
<p>再往上，就是漏洞利用。漏洞利用的目的有两点：未授权安装、运行代码和规避杀软检测。其中 0 day 漏洞危害和成本要远大于 1/N day 漏洞。各种 APT 攻击中，出现过许多操作系统漏洞、路由器或交换机网络设备漏洞，以及 office，Flash，PDF 等应用漏洞。此种攻击往往搭配其他手法，组合进行入侵。例如容器漏洞在渗透攻击中的利用，以及 Office 漏洞在钓鱼中的利用。</p>
<p>漏洞入侵之上是供应链攻击，典型的例子如 XSHELL 、CCleaner、华硕软件更新劫持等攻击事件。在突破上游供应商后，在极短的时间内进行资产摸排、更改、下发、劫持。又同时可以顺利筛选、控制下游目标。整套流程下来，及其考验攻击组织的技术能力，协调能力，后勤能力及储备和信息收集能力。</p>
<p>最顶层是物理接触，典型的攻击事件：“震网”。这种比较少见，不多说。</p>
<p>APT 攻击是否成功，取决于攻击者的目的和所具有的入侵能力，与目标防御强弱无关。防御强弱和目标的价值决定了入侵的方式。漏洞利用，特别是 0 day 漏洞都是针对高价值，特定目标，考虑到入侵成本，APT 攻击更倾向于其他的入侵方式。</p>
<h2 id="0x02-apt">0x02 APT 事件分析<a class="headerlink" href="#0x02-apt" title="Permanent link">&para;</a></h2>
<p>在事件分析的初期，我们拿到的线索是破碎零散的，这些线索只是攻击者为了达成目的采取的手段，我们做安全分析，其实是对攻击手段上下文的描述。</p>
<p>事件有四个核心元素，攻击者、受害者、基础设施和能力。我们分析 APT，可以从受害者、基础设施和能力三个角度进行切入。具体方法分为两种。</p>
<h3 id="0x02-00-apt">0x02-00 APT 两种分析方法<a class="headerlink" href="#0x02-00-apt" title="Permanent link">&para;</a></h3>
<h4 id="_1">通过攻击者“能力”切入分析：<a class="headerlink" href="#_1" title="Permanent link">&para;</a></h4>
<p>基于能力的分析方法，对应的是样本分析。样本分析要关注样本的行为及上下文关系。</p>
<p>样本行为包括样本的恶意行为、驻留、子进程创建，释放文件、网络请求等。其中要注意样本中携带的信息和加解密、攻击技术、对抗技术方面的特征。这些携带的信息和特征有助于关联匹配到其他样本。</p>
<p>入侵过程中往往有 fake (Downloader)，有 Dropper，有 backdoor；各个阶段还会包含伪装、漏洞利用。初期拿到的样本通常只是其中一个。样本分析是事件分析的基础，只有弄清样本的上下文关系，才能理顺攻击手段。</p>
<p>样本分析同学以恶意软件为起点，针对技术（加解密、攻击技术、对抗技术），C2 结构和恶意软件上下文进行分析。根据恶意软件的特征匹配其他样本，扩大分析面。期望分析得到的结果：</p>
<ul>
<li>受害者的信息</li>
<li>基础设施列表</li>
<li>使用的技术</li>
<li>样本的一些特征</li>
<li>匹配到其他样本</li>
</ul>
<p>各大厂商的 APT 报告都是以攻击者能力切入，所以看到大量篇幅都是恶意软件技术报告。</p>
<h4 id="_2">通过攻击者“基础设施”切入分析<a class="headerlink" href="#_2" title="Permanent link">&para;</a></h4>
<p>基于基础设施的分析方法是 C2 关联分析。是描述事件上下文最有效的方法。</p>
<p>样本中多少会暴露一些基础设施信息；或是 IP，或是域名。通过 WHOIS 信息来发现统一注册者的不同域名。进一步研究可以得到针对不同攻击者的恶意软件信息（相似/相同的基础设施）。期望分析得到的结果：</p>
<ul>
<li>与该基础设施有联系的受害者</li>
<li>该基础设施下发\上传、命令控制等行为</li>
<li>关联到其他基础设施</li>
</ul>
<p>分析过程中要注意一点，样本分析和关联分析并不是独立进行的。</p>
<p>对恶意软件进行分析，得到其中的 C2 基础设施。通过对 C2 的关联分析，找到了同一基础设施下发的其他样本。之后再对样本进行分析……由此形成了一个循环。最后的效果，差不多是这样的：</p>
<p><img alt="img" src="https://projectsharp.org/images/2020/02/23/apt-ttps/2.png" /></p>
<p>举一个简单的例子：我们拿到初始样本 A，进行恶意软件分析，得到其中的 C2：域名 A 和域名 B，对 C2 基础设施关联分析，发现具有相同基础设施的样本 B。通过对样本 B 逆向分析，得到新的 C2 域名 C。这仅仅是一个循环，分支上就已经可以关联到许多信息。这个循环越多，找到的线索越多，最后事件分析的完整度就越高。</p>
<h3 id="0x02-01-ioc">0x02-01 IoC 层级<a class="headerlink" href="#0x02-01-ioc" title="Permanent link">&para;</a></h3>
<p>IoC (Indicators of Compromise) 在取证领域被定义为计算机安全性被破坏的证据。在 APT 领域作用就是描述攻击者得恶意活动。分析人员对 IoC 进行识别和关联，来寻找恶意活动背后得事件和潜在得威胁。APT 分析工作都是围绕 IoC 进行的。</p>
<p>分析过程中遇到的 IoC 有以下几种：</p>
<ul>
<li>hash</li>
<li>IP</li>
<li>域名</li>
<li>网络</li>
<li>主机特征</li>
<li>工具</li>
<li>TTPs</li>
</ul>
<p>这些 IoC 的地位并不是相同的，其中一些指标远比其他指标更有价值。David Bianco提出了 <a href="https://detect-respond.blogspot.com/2013/03/the-pyramid-of-pain.html">Pyramid of Pain</a>，描述了 IoC 之间的层级关系。</p>
<p><img alt="img" src="https://projectsharp.org/images/2020/02/23/apt-ttps/3.png" /></p>
<ul>
<li>hash：</li>
</ul>
<p>指样本文件的哈希值。通常用于提供对特定恶意软件样本或涉及入侵的文件的唯一标识。hash 值是分析人员最容易拿到的 IoC，但是哈希值很容易改变，文件中更改一个字节，都会影响文件哈希。很多情况下不值得跟踪。</p>
<ul>
<li>IP： 绝大多数恶意软件都有网络行为，其中一定会涉及 IP，但是如果攻击者使用匿名代理或者 Tor，IP 十分容易改变。</li>
<li>域名： 域名和 IP 类似，但是域名需要注册，要付出一定的费用。因为 DNS 解析需要时间，即使使用 DNS 服务商提供的免费域名服务，但是还会有时间成本。所以，域名稍比 IP 稳定一点。</li>
<li>网络特征： 指 C2 上，比较有区分度得特征。比如，恶意软件请求 C2 上指定路径的资源文件，如：<code>GET xxx[.]com/AWDA/a.exe</code>、<code>GET xxx[.]com/AWDA/get.php?fun=xx&amp;ad=xx</code>，或者向指定位置上传文件：<code>POSTxxx[.]com/AWDA/img.php</code>等，<code>AWDA/a.exe</code>、<code>AWDA/get.php?fun=xx&amp;ad=xx</code>、<code>AWDA/img.php</code> 这些就是网络特征。攻击者可能会架设多个 C2，多渠道撒布大量恶意软件。只要 C2 指令结构不变，网络特征很难改变。</li>
<li>主机特征： 指恶意样本中，携带的攻击者主机的一些特征。这些特征不容易发现。但是对匹配其他样本、定位攻击者意义重大。后面有章节详细介绍。</li>
<li>工具： APT 攻击中，为了达到某种目的，攻击者往往会使用、研发、定制一些工具。比如 APT 28 使用的 DealersChoice、Xagent。攻击者定制、自研一些工具，肯定要花费一定的成本。如果对攻击套件进行准确识别，攻击者只能放弃目前所使用的工具，这样无疑加大了下次攻击的成本。</li>
<li>TTP： Tactics, Techniques, and Procedures (战术、技术、过程)。是对攻击者攻击行为，战略战术层次的描述。I /域名可以更改，网络主机特征也容易消除、工具可以重新开发。但是攻击的战略战术往往很难改变，如果能识别出 TTP 特征，攻击者要么放弃攻击，要么指定新的战术。这对 actor 将是致命的打击。在 IoC 的层次结构中，由下到上获取难度依次增高，同时改变的难度和价值也是增长的。处于最顶端的是 TTP，这是最有价值和最难获取的 IoC。下面聊一聊 TTPs 提取。</li>
</ul>
<h2 id="0x03-ttps">0x03 TTPs 提取<a class="headerlink" href="#0x03-ttps" title="Permanent link">&para;</a></h2>
<p>TTP 是什么？</p>
<p>TTP: Tactics, Techniques, and Procedures (战术、技术、过程)</p>
<ul>
<li>战术：攻击者从信息收集开始到目的达成的攻击策略。攻击的目标、攻击目的、前期信息收集方式、对目标攻击的入口点、载荷投递方式等等都可以划分在战术指标里面。</li>
<li>技术：为了达成攻击目的，Actor 通常在具体事件中使用各种技术。这些技术旨在突破防御，维护 C2，横向移动，获得信息、数据等。</li>
<li>过程：要进行成功的攻击，仅仅拥有良好的战术和技术是不够的。还需要一组精心策划的战术动作来执行才可以。</li>
</ul>
<h3 id="0x03-00-ttp">0x03-00 TTP 提取的难点<a class="headerlink" href="#0x03-00-ttp" title="Permanent link">&para;</a></h3>
<p>战术、技术、过程三个词过于抽象，目前没有很好的方案对 TTP 进行实体描述。</p>
<p>再者就是，相关的资料过于匮乏。国外技术封锁、而国内做 APT 研究的能力性安全厂商寥寥无几。 曾从事过一段时间 APT 分析，结合钻石分析模型、Kill chain，摸索出一种描述 TTP 的方法：特征矩阵和事件链图。</p>
<p>不管是 IoC、IoA、SITX 还是 ATT&amp;CK ，目前市面上都没有成熟的方案对 TTP 进行描述，特别是 ATT&amp;CK ，因为过度炒作，目前已经有点妖魔化。本篇不对 ATT&amp;CK 过多探讨，可以参考阅读<a href="https://zhuanlan.zhihu.com/p/73172883">《安全分析中的威胁情报（二）：ATT&amp;CK》</a> 和 <a href="https://weibo.com/ttarticle/p/show?id=2309404450471736639616">《关于ATT＆CK/APT/归因的讨论》</a>以示正听。ATT&amp;CK 对 TTP 提取的帮助，后文会进行讨论。</p>
<h3 id="0x03-01">0x03-01 特征矩阵<a class="headerlink" href="#0x03-01" title="Permanent link">&para;</a></h3>
<p>特征矩阵是对特征的事件分析过程中，攻击者能力，基础设施，战略等方面的特征总述。</p>
<p>整体分为三个部分，基础设施特征、技术特征、战略特征。</p>
<ul>
<li>基础设施特征中包含 C2 列表、网络特征和样本中携带的主机特征。</li>
<li>技术特征包含加解密技术、攻击技术和对抗技术。</li>
<li>战略特征包含目标群体、攻击入口和载荷投递。</li>
</ul>
<p>大体的框架如图所示，一些指标要根据实际情况进行调整：</p>
<p><img alt="img" src="https://projectsharp.org/images/2020/02/23/apt-ttps/4.jpg" /></p>
<ul>
<li>战略/战术： 包含目标群体、攻击入口和载荷投递方式和释放流程。攻击入口、载荷投递方式和释放流程可以在样本分析中进行总结。</li>
</ul>
<p>事件四个核心元素，攻击者、受害者、能力、基础设施。上面所讲了通过能力和基础设施切入进行事件分析。此外，还可以通过受害者进行切入分析，得到攻击者的一些战略信息。例如，攻击者为了提高成功率，会贴合受害者定制一些攻击邮件或者文件，通过其中精心构造的邮件名、正文、附件内容，可以反推受害者群体，以此揣摩攻击者的战略目的。</p>
<ul>
<li>基础设施： 基础设施分为 C2、网络特征、主机特征。因为会有基础设施重用的情况，C2 列表一定要有；再者就是 URL 上面的网络特征以及样本中携带的主机特征。主机特征有很多，例如样本生成的开发/打包工具语言、配置，PDB 调试文件路径、源码路径可以看出攻击者的一些习惯；样本、签名证书的生成时间推断攻击者所在地区、如果数据量大的话，还能根据节假日、休息日推断所在国家。如果有文档类样本，还会有文档所有者、修改者这些攻击者个人信息。</li>
<li>技术： 技术特征分为加解密、攻击技术、对抗技术、C2 技术。技术特征太多了，加密算法、使用的工具、持续部署的方案、漏洞利用、C2 通信方式、反杀软、行为隐藏……工具使用，代码重用这些情况都可能导致技术上的重叠。</li>
</ul>
<p>以上的特征分析方法对应：</p>
<ul>
<li>战略战术 -&gt; 受害者分析</li>
<li>基础设施 -&gt; 样本分析 + 关联分析</li>
<li>技术特征 -&gt; 样本分析</li>
</ul>
<p>TTP 是 Tactics, Techniques, and Procedures。得到的特征矩阵，更多的是在能力和基础设施方面上的特征，Procedures 上面的体现很弱。为了弥补这一点，推出事件链图来表示攻击事件的上下文，体现战术特征。</p>
<h3 id="0x03-02">0x03-02 事件链图<a class="headerlink" href="#0x03-02" title="Permanent link">&para;</a></h3>
<p>在说事件链图时，先补充几个概念。</p>
<h4 id="kill-chain">KILL CHAIN<a class="headerlink" href="#kill-chain" title="Permanent link">&para;</a></h4>
<p>入侵的本质：攻击者开发有效的载荷突破防御，在可信赖的环境中实现驻留，以便接下来的行动。这种行动可能是横向移动、窃密、破坏完整性或可用性等。</p>
<p>洛克希德马丁公司，在 2011 年发布的一篇论文《<a href="https://www.lockheedmartin.com/content/dam/lockheed-martin/rms/documents/cyber/LM-White-Paper-Intel-Driven-Defense.pdf">Intelligence-Driven Computer Network Defense Informed byAnalysis of Adversary Campaigns and Intrusion Kill Chains</a> 》中描述了一种名为 Kill Chain 的入侵分析模型。通过对入侵的理解，杀伤链将攻击定义为7个阶段：</p>
<ul>
<li>Reconnaissance (侦察)</li>
<li>Weaponization (武器构建)</li>
<li>Delivery (载荷投递)</li>
<li>Exploitation (漏洞利用)</li>
<li>Installation (驻留)</li>
<li>C2 (命令控制)</li>
<li>Actions on Objectives (采取行动)</li>
</ul>
<p>前面的六个阶段都是为最后采取行动做铺垫。当入侵成功实现驻留之后，恶意软件将会通过 C2 命令执行一些横向移动、窃密、破坏、勒索等一些恶意行为。介绍 Kill Chain 的文章已经很多，不再赘述。</p>
<h4 id="_3">攻击总是线性的<a class="headerlink" href="#_3" title="Permanent link">&para;</a></h4>
<p>攻击者不可能隔空，也不可能不借助外有资源和能力达成攻击目的。</p>
<p>举一个简单的例子：</p>
<div class="highlight"><pre><span></span><code>攻击者投递含有 cve-2017-11882 的钓鱼邮件，受害者打开了钓鱼文件，漏洞利用成功，文档从远程拉取执行了后门。
</code></pre></div>
<p>将描述的实体抽离出来，就是这个样子：</p>
<div class="highlight"><pre><span></span><code>outlook -&gt;
Explorer -&gt;
office -&gt;
EQNEDT32 -&gt;
[NET] -&gt;
Explorer -&gt;
Payload
</code></pre></div>
<p>简单梳理一下， 此描述的攻击动作，其中将使用到的行为主体有 outlook，资源管理器，office，公式编辑器，网络和最终的 payload。每一个步骤都是首尾相连，且没有中断的。</p>
<p><strong>攻击在观测空间内的动作一定是呈线性关系的。操作的对象、攻击的动作一定是有明确的目的和明显的前后关系。</strong></p>
<h4 id="apt">APT 分析单位<a class="headerlink" href="#apt" title="Permanent link">&para;</a></h4>
<p>在此规定一下，事件为 APT 分析的最小单位，而不是样本。</p>
<div class="highlight"><pre><span></span><code>样本分析 ∈ 事件分析

事件分析 ∈ 攻击战术分析
</code></pre></div>
<p>一次完整的分析要包含完整独立攻击上下文。当然，事件之间是关联的。比如，攻击者发送钓鱼邮件，其中包含钓鱼网站链接，受害者接收钓鱼邮件并且点开钓鱼链接下载并运行了恶意软件。这是三个独立事件：邮件钓鱼、钓鱼网站、恶意软件执行。</p>
<p>因为在杀伤链模型中，邮件钓鱼、钓鱼网站、恶意软件有各不相同入侵过程。虽然整个攻击是连贯的，还是要将各个步骤拆解出来，单独进行事件分析。</p>
<p>为了表述事件链图。指定以下场景：</p>
<div class="highlight"><pre><span></span><code>APT 组织对某机构进行攻击：
攻击者通过 google hacking 搜寻到所属该单位的某雇员，通过社交平台找到其 163 邮箱。
对该员工发送钓鱼邮件，其中包含 163 邮箱钓鱼网站。
雇员查看钓鱼网站，泄漏了自己 163 邮箱密码。
攻击者登陆邮箱，查看往来信件，锁定高价值目标。
向高价值目标发送钓鱼邮件，其中包含有漏洞利用的文档。
文档被打开，主机被感染，窃取到机密文件。
</code></pre></div>
<p>以上整个攻击，用事件链图描绘出来：</p>
<p><img alt="img" src="https://projectsharp.org/images/2020/02/23/apt-ttps/5.png" /></p>
<p>入侵的上下文用实线连接，事件之间的上下文用虚线连接。就构成了基于杀伤链的事件链图。</p>
<p>但是 APT 攻击手法是多样的，设立的场景中，钓鱼邮件进行恶意文档投递，水坑攻击不行么？最终后门是通过利用文档漏洞进行恶意代码执行，使用浏览器漏洞是不是更高效？所以我们将链图再进一步抽象，就得到最后成品：</p>
<p>攻击的入口和方法很多，但是攻击事件的上下文基本上是类似的。</p>
<p><img alt="img" src="https://projectsharp.org/images/2020/02/23/apt-ttps/6.png" /></p>
<p>因为场景十分简单，实际的 APT 攻击，制作出来的链图要比这一个丰富的多。</p>
<h2 id="0x04-ttps">0x04 TTPs 的使用及归因判断<a class="headerlink" href="#0x04-ttps" title="Permanent link">&para;</a></h2>
<p>首先是特征矩阵，特征矩阵着重对 APT 活动技术上面进行描述。</p>
<p><img alt="img" src="https://projectsharp.org/images/2020/02/23/apt-ttps/7.png" /></p>
<p>两个活动 A 和 B，将特征矩阵由 A 到 B 进行映射，相同颜色部分标识相同特征。区域的颜色标识特征的置信度。当置信度达到一定阈值后。我们就可以将两个活动关联起来，认为是同一攻击组织所为。 之前 IoC 层级中提到，不同的 IoC 他的更改难易程度不同，所以各种 IoC 的价值也不同。在这里也是适用的。</p>
<p>在特征矩阵映中，映射到的部分权重也而不相同。参照 Pyramid of Pain，制作一个 Pyramid of Features：</p>
<p><img alt="img" src="https://projectsharp.org/images/2020/02/23/apt-ttps/8.jpg" /></p>
<p>自下而上，一共七层。最底层是样本中硬编码的字符串和样本中携带的主机特征、这些是最容易改变且经常用来迷惑分析人员的指标。往上是 C2 上面的特征，这些也很容易改变，但是同批样本，同一活动的 C2 结构基本相同。在往上是样本中的一些攻击技术和对抗技术。处于顶层的时加密方式、密钥、使用的攻击，漏洞利用技术、C2 和独特的算法。</p>
<p>加密方式和密钥以上在关联分析中的置信度已经很高了，特别是非对称加密的密钥，但是生存时间短，经常用过几次后就被弃用。再一个是使用的工具和漏洞利用技术，在 Pyramid of Pain 也提到了，工具的开发需要大量的人力金钱成本，这些特征不容易改变。</p>
<p>APT 组织，有基础设施重用的情况，如果看到相同的 C2，基本就确定活动关联，但是要注意 C2 生命的连续性，如果域名 1 月份注册到期，过了保护期，6 月份时再次活跃，是不是同一攻击者还需思量。独特的算法包括加密算法、有特点的攻击技术、对抗技术。</p>
<p>金字塔上的特征有下到上，特征的改变难度越高、价值越高，使得在分析时，权重和置信度也越高。</p>
<p>如果特征上，置信度叠加不高，就可以在事件链图中进行匹配：</p>
<p><img alt="img" src="https://projectsharp.org/images/2020/02/23/apt-ttps/9.png" /></p>
<p>A 是所掌握的某组织的事件链图，B 是独立攻击的事件链图。</p>
<p>红色部分为匹配到的相同特征，如果特征置信度达不到一定阈值。可以观察 A 攻击的上下文，与所掌握 B 的信息是否相符。如果上下文重合度高。可以增加 B∈A 的可能性。</p>
<p>TTP 是有生命周期的。APT 攻击在对抗中升级，技术、战术特征会在一段时间后变的面目全非。</p>
<p>归因判断不仅仅可以通过特征矩阵进行特征匹配，还可以通过事件链图攻击上下文进行佐证。</p>
<h3 id="0x05-ttps">0x05 TTPs 落地的思考<a class="headerlink" href="#0x05-ttps" title="Permanent link">&para;</a></h3>
<p>一个东西提出后，首先要思考的是它产生的背景，自身的价值，适用的范围，解决的问题，存在的不足以及可行的落地场景和具体方案。</p>
<p>TTP 的意义在于可以对一起攻击事件、一个攻击组织高度的总结。可以帮助我们对攻击进行及时的感知和阻断。此外，TTP 另一个用处就是归因判断。</p>
<h3 id="0x05-01">0x05-01 实体抽取<a class="headerlink" href="#0x05-01" title="Permanent link">&para;</a></h3>
<p>不管用作防御的感知和阻断，还是在研究领域的归因判断。落地前需要解决的第一个问题就是人类语言向机器语言的转变，也就是行为实体抽取和可机读。</p>
<p>前文提出了一个观点：攻击是线性的，且不可能隔空进行操作。将操作对象视为原点，操作视为方向，其构成的向量即代表本次的攻击动作，向量的顶点即表示下一个操作对象。这些一个个的攻击动作首尾相连构成攻击行为，最终指向的便是攻击目的。</p>
<p><img alt="img" src="https://projectsharp.org/images/2020/02/23/apt-ttps/10.png" /></p>
<p>进行 TTP 提取的前提是，梳理出完整的攻击流程和操作对象。而图中所示的操作对象，便是需要抽取的实体。“操作对象” 具有以下特点：</p>
<ul>
<li>攻击过程中的支撑点</li>
<li>攻击过程中更改、操作及运行的对象。</li>
<li>操作的载体</li>
<li>攻击中所需要的资源（运算、网络）</li>
</ul>
<p>还是那个例子：</p>
<div class="highlight"><pre><span></span><code>攻击者投递含有 cve-2017-11882 的钓鱼邮件，受害者打开了钓鱼文件，漏洞利用成功，文档从远程拉取执行了后门。
</code></pre></div>
<p>outlook，资源管理器，office，公式编辑器，网络和最终的 payload 这些都都是操作对象。他们直接或间接的受控于攻击者。</p>
<h3 id="0x05-02">0x05-02 关系描述<a class="headerlink" href="#0x05-02" title="Permanent link">&para;</a></h3>
<p>“事件链图” 是描述 TTP 的重要方法，它着重强调了攻击的上下文关系，以及操作对象之间的关联关系。在事件链图描述中，每一个方块实际就是操作对象。除此之外另外一个维度就是关联关系，也就是 “操作”，对应事件链图中连接方块的边。</p>
<p>操作可以理解为攻击动作。人类知识转变为机器语言是困难的，将攻击动作进行可机读的表述需要借助一个东西：ATT&amp;CK。</p>
<h4 id="attck-ttp">ATT&amp;CK 对 TTP 提取的帮助<a class="headerlink" href="#attck-ttp" title="Permanent link">&para;</a></h4>
<p>ATT&amp;CK 的价值在于统一了行为标记和描述的标准。它对攻击性操作进行细分和分类，有了这种完善的参照，极大减少了 “行为抽象” 的成本。</p>
<p>进行 TTP 描述，需要对攻击的动作进行一种标准化描述。我们所要描述的 “关系”，其实是表达 “攻击者借助何种基础设施，采用何种方法对受害者产生影响的过程”，这是一种带有明显方向性的特征。就像标量不能描述矢量一样，狭义的 IOC 是不能描述 TTP 和攻击上下文的。</p>
<p>MITRE 提出了 STIX (Structured Threat Information eXpression), CrowdStrike 提出了 IOA (Indicator of Attack)，他们都意识到 IOC 是不足以描述丰富多变的网络安全环境，也不能描述复杂的上下文关系。STIX 通过 Observables (可观察对象)、Indicators (上下文关联)、Incidents (上下文实例)、TTP、Exploit Target (弱点)、Campaign (意图)、ThreatActors (恶意行为特征)、Courses Of Action (反应措施) 描述攻击；而 IOA 主要表达攻击者必须采取的什么行动才能达成目的。</p>
<p>不管是何种方式，IOA、SITX 都是在尝试去描述攻击过程这一 ”矢量“，而 ATT&amp;CK 的出现就像胶水一样，很好的将 ”部件“进行粘合。丰富且适用的字典可以帮助描述操作对象的上下文关系，进而帮助对 TTP 进行抽象描述。</p>
<p>ATT&amp;CK 让攻击描述可以聚焦于更加抽象的过程总结，而不必纠结这个攻击的实际步骤。并且采用统一的描述方法，实现了可机读，以及可以更好的进行信息交换，降低数据转入转出成本，提高信息适用性和可拓展性。</p>
<h4 id="attck">使用 ATT&amp;CK 进行关系映射<a class="headerlink" href="#attck" title="Permanent link">&para;</a></h4>
<p>使用 ATT&amp;CK 关系映射分为两种：人工映射以及自动化匹配。</p>
<p>人工映射无非就是打标签，分析人员在分析过程中，通过自身知识的总结攻击活动，人工到 ATT&amp;CK 矩阵中去匹配。自动化映射是指，机器去理解攻击的上下文关系，通过一些算法，将攻击过程去 ATT&amp;CK 矩阵中去匹配。</p>
<p>人工映射十分准确，既然是人，肯定有自己擅长的领域以及知识盲区，“人” 对非擅长领域的信息是很难进行判断的；同时，人的精力是有限的，面对海量信息显得有些乏力。为了解决人工映射的弊端，业内有自动化映射的研究，不可否认，自动化映射更符合真实环境需求。受限于当前机器学习发展的瓶颈，很难有一个算法可以全自动地进行 ATT&amp;CK 映射。</p>
<p>结合 “事件链图”，使用 ATT&amp;CK 映射关联关系可以从四个角度入手：</p>
<ul>
<li>环境：动作所处的环境，例如操作系统，执行环境（内存、命令行、SQL 等）</li>
<li>实现：进行了何种操作，例如文件释放，网络请求，数据修改等</li>
<li>操作对象：如释放的文件类型，注册表等</li>
<li>特征：有一些攻击动作，需要特定的条件，比如 T1170，T1156，T1086 等，这种，检测到相关特征，便可进行直接映射。</li>
</ul>
<p>自动化映射需要结合自身系统的设计和需求，因人制宜，不过多的讨论。</p>
<h3 id="0x05-03">0x05-03 完整的描述模型<a class="headerlink" href="#0x05-03" title="Permanent link">&para;</a></h3>
<p>经过优化， 可以将 “事件链图” 描述为：</p>
<p><img alt="img" src="https://projectsharp.org/images/2020/02/23/apt-ttps/11.png" /></p>
<p>方块表示操作对象，边表示操作对象之间的操作，也就是 ATT&amp;CK 所描述的那部分。每两个实体和边看作一个最小分析单位，如图中红框所示。其构成的最小元组表达为：</p>
<div class="highlight"><pre><span></span><code>(Node1 {Labels:&#39;xxx&#39;})-[:Relationships {Labels:&#39;xxx&#39;}]-&gt;(Node2)
</code></pre></div>
<p>每一个操作对象、实体表达为<code>（Node）</code>。关联关系表达为<code>[:Relationships]</code>。实体和关联关系都具有属性信息。</p>
<p>Node 的属性信息，可以是资源路径，捕获时附带的信息，带有的命令行参数等等。一切和操作对象实体有关的信息都可以放在里面。Relationships 描述攻击过程和实体之间的关系，可以基于 ATT&amp;CK 进行描述，属性信息包含攻击击过程的环境，实现，特征或者其他一切信息。总的说，关注的是4种内容：</p>
<ul>
<li>实体</li>
<li>实体的属性</li>
<li>关联关系</li>
<li>关联关系的属性</li>
</ul>
<p>基于此种描述模型，可以延伸出两种 TTP 描述方法：</p>
<ul>
<li>关注实体的 TTP 描述方法（特征矩阵）</li>
<li>关注关联的 TTP 描述方法（事件链图）</li>
</ul>
<p>特征矩阵中的信息，大多可以映射到实体属性上。关注实体的 TTP 描述方法更多的是在能力和基础设施方面的特征。关注关联的 TTP 描述方法，着重上下文关系，更能体现体现战术特征。当然也可以将两者进行融合，只不过我将其归为第二类。因为描述上下文时，也需要操作对象（实体）的属性信息。</p>
<p>那么如何设计数据结构呢？可以使用 json 嵌套，也可以使用 STIX ，当然也可以自己设计标准。此处留一点想象空间。😜</p>
<h2 id="0x06">0x06 参考链接<a class="headerlink" href="#0x06" title="Permanent link">&para;</a></h2>
<ul>
<li>https[:]//www[.]lockheedmartin[.]com/content/dam/lockheed-martin/rms/documents/cyber/LM-White-PaperIntel-Driven-Defense.pdf</li>
<li>http[:]//pwc[.]blogs[.]com/cyber_security_updates/2015/05/diamonds-or-chains.html</li>
<li>https[:]//ti[.]360[.]net/uploads/2018/01/26/65f86ec75d7775677676515122363c69.pdf</li>
<li>https[:]//www[.]lockheedmartin[.]com/content/dam/lockheed-martin/rms/documents/cyber/LM-White-Paper-Intel-Driven-Defense.pdf</li>
<li>https[:]//zhuanlan[.]zhihu[.]com/p/73172883</li>
<li>http[:]//detect-respond[.]blogspot[.]com/2013/03/the-pyramid-of-pain.html</li>
<li>https[:]//weibo[.]com/ttarticle/p/show?id=2309404450471736639616</li>
<li>https[:]//www[.]fireeye[.]com/blog/threat-research/</li>
<li>https[:]//ti[.]qianxin[.]com/blog/</li>
</ul>
<h2 id="_4">鸣谢<a class="headerlink" href="#_4" title="Permanent link">&para;</a></h2>
<p>主要内容成文于两年前，感谢当时 Redrain、cyg07 对我教导和帮助。</p>
                
                  
                
              
              
                


              
            </article>
          </div>
        </div>
        
      </main>
      
        
<footer class="md-footer">
  
    <nav class="md-footer__inner md-grid" aria-label="Footer">
      
        
        <a href="../../OSINT/OSINT_framework/" class="md-footer__link md-footer__link--prev" aria-label="上一页: OSINT 框架" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                上一页
              </span>
              OSINT 框架
            </div>
          </div>
        </a>
      
      
        
        <a href="../../../WEB/Practice_platform/" class="md-footer__link md-footer__link--next" aria-label="下一页: Web练习平台" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                下一页
              </span>
              Web练习平台
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg>
          </div>
        </a>
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        Made with
        <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
          Material for MkDocs
        </a>
        
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": "../../../../..", "features": [], "translations": {"clipboard.copy": "\u590d\u5236", "clipboard.copied": "\u5df2\u590d\u5236", "search.config.lang": "ja", "search.config.pipeline": "trimmer, stemmer", "search.config.separator": "[\\uff0c\\u3002]+", "search.placeholder": "\u641c\u7d22", "search.result.placeholder": "\u952e\u5165\u4ee5\u5f00\u59cb\u641c\u7d22", "search.result.none": "\u6ca1\u6709\u627e\u5230\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.one": "\u627e\u5230 1 \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.other": "# \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing", "select.version.title": "Select version"}, "search": "../../../../../assets/javascripts/workers/search.409db549.min.js", "version": null}</script>
    
    
      <script src="../../../../../assets/javascripts/bundle.56a63758.min.js"></script>
      
    
  </body>
</html>